<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Swim Lesson Directory – FloatSwim</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Browse swim lesson providers by state, cost, and type. Compare free, low-cost, and professional swimming programs for infants and children near you." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://floatswim.org/directory.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="Swim Lesson Directory – FloatSwim" />
  <meta property="og:description" content="Browse swim lesson providers by state, cost, and type. Compare free, low-cost, and professional swimming programs near you." />
  <meta property="og:url" content="https://floatswim.org/directory.html" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="FloatSwim" />
  <meta property="og:image" content="https://floatswim.org/img/banner_1200x630.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Swim Lesson Directory – FloatSwim" />
  <meta name="twitter:description" content="Browse swim lesson providers by state, cost, and type. Compare free, low-cost, and professional swimming programs near you." />
  <meta name="twitter:image" content="https://floatswim.org/img/banner_1200x630.png" />

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon_32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon_16.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon_180.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/img/favicon_192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/img/favicon_512.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="style.css" />

  <!-- GSAP -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/gsap.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/ScrollTrigger.min.js" defer></script>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "Swim Lesson Providers",
    "description": "A directory of free and low-cost swim lesson providers across the United States.",
    "url": "https://floatswim.org/directory.html",
    "numberOfItems": 1245
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://floatswim.org/" },
      { "@type": "ListItem", "position": 2, "name": "Directory", "item": "https://floatswim.org/directory.html" }
    ]
  }
  </script>
</head>
<body>
  <header>
    <div class="shell">
      <div class="nav">
        <div class="brand">
          <div class="brand-mark">FS</div>
          <div class="brand-text">
            <div class="brand-name">FloatSwim</div>
            <div class="brand-tagline">Awareness. Safety. Hope.</div>
          </div>
        </div>
        <nav>
          <a href="index.html">Home</a>
          <a href="dashboard.html">Dashboard</a>
          <a href="about.html">About</a>
          <a href="resources.html">Resources</a>
          <a class="active" href="directory.html">Directory</a>
          <a href="roadmap.html">Roadmap</a>
          <a href="share-story.html">Share a Story</a>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <div class="shell">
      <!-- SWIM LESSON DIRECTORY -->
      <div data-fs-directory></div>
    </div>
  </main>

  <footer>
    <div class="shell footer-inner">
      <div>&copy; <span id="year"></span> FloatSwim. All rights reserved.</div>
      <div>
        <a href="index.html#why">Why this matters</a> ·
        <a href="index.html#parents">For parents</a> ·
        <a href="index.html#stories">Stories</a> ·
        <a href="index.html#get-involved">Get involved</a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>

<script>
(function () {
  var stateName = {
    AL: "Alabama", AK: "Alaska", AZ: "Arizona", AR: "Arkansas", CA: "California",
    CO: "Colorado", CT: "Connecticut", DE: "Delaware", FL: "Florida", GA: "Georgia",
    HI: "Hawaii", ID: "Idaho", IL: "Illinois", IN: "Indiana", IA: "Iowa",
    KS: "Kansas", KY: "Kentucky", LA: "Louisiana", ME: "Maine", MD: "Maryland",
    MA: "Massachusetts", MI: "Michigan", MN: "Minnesota", MS: "Mississippi", MO: "Missouri",
    MT: "Montana", NE: "Nebraska", NV: "Nevada", NH: "New Hampshire", NJ: "New Jersey",
    NM: "New Mexico", NY: "New York", NC: "North Carolina", ND: "North Dakota", OH: "Ohio",
    OK: "Oklahoma", OR: "Oregon", PA: "Pennsylvania", RI: "Rhode Island", SC: "South Carolina",
    SD: "South Dakota", TN: "Tennessee", TX: "Texas", UT: "Utah", VT: "Vermont",
    VA: "Virginia", WA: "Washington", WV: "West Virginia", WI: "Wisconsin", WY: "Wyoming"
  };

  var els = {};
  var state = { all: [], byState: {}, q: "", st: "", cost: "", type: "", page: 1, pageSize: 25 };

  function $(id) { return document.getElementById(id); }

  function esc(s) {
    return String(s || "").replace(/[&<>"']/g, function (c) {
      return { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[c];
    });
  }

  function norm(s) { return String(s || "").toLowerCase().trim(); }

  function matchText(rec, q) {
    if (!q) return true;
    var t = [rec.provider_name, rec.program_name, rec.city, rec.state, rec.notes, rec.provider_type, rec.cost_type].join(" ");
    return norm(t).includes(norm(q));
  }

  function applyFilters(list) {
    return list.filter(function (rec) {
      if (state.st && state.st !== "all" && rec.state !== state.st) return false;
      if (state.cost && rec.cost_type !== state.cost) return false;
      if (state.type && rec.provider_type !== state.type) return false;
      if (!matchText(rec, state.q)) return false;
      return true;
    });
  }

  function uniqValues(list, key) {
    var set = new Set();
    for (var i = 0; i < list.length; i++) {
      var v = String(list[i][key] || "").trim();
      if (v) set.add(v);
    }
    return Array.from(set).sort(function (a, b) { return a.localeCompare(b); });
  }

  function setOptions(selectEl, values, placeholder) {
    selectEl.innerHTML = "";
    var opt0 = document.createElement("option");
    opt0.value = "";
    opt0.textContent = placeholder;
    selectEl.appendChild(opt0);
    for (var i = 0; i < values.length; i++) {
      var opt = document.createElement("option");
      opt.value = values[i];
      opt.textContent = values[i];
      selectEl.appendChild(opt);
    }
  }

  function setStateOptions() {
    var states = Object.keys(state.byState).filter(function (k) { return k && k !== "NA"; }).sort();
    els.filterState.innerHTML = "";
    var o0 = document.createElement("option");
    o0.value = "";
    o0.textContent = "All states";
    els.filterState.appendChild(o0);
    for (var i = 0; i < states.length; i++) {
      var st = states[i];
      var o = document.createElement("option");
      o.value = st;
      o.textContent = (stateName[st] ? stateName[st] + " " : "") + "(" + state.byState[st].length + ")";
      els.filterState.appendChild(o);
    }
  }

  function openModal(rec) {
    els.modalTitle.textContent = rec.provider_name || "Provider";
    els.modalBody.innerHTML = [
      row("Program", rec.program_name),
      row("Type", rec.provider_type),
      row("Cost", rec.cost_type),
      row("Ages", rec.ages),
      row("Address", [rec.address, rec.city, rec.state, rec.zip].filter(Boolean).join(", ")),
      row("Phone", rec.phone),
      row("Email", rec.email ? '<a href="mailto:' + esc(rec.email) + '">' + esc(rec.email) + "</a>" : ""),
      row("Website", rec.website ? '<a href="' + esc(rec.website) + '" target="_blank" rel="noopener">Visit provider</a>' : ""),
      row("Source", rec.source_url ? '<a href="' + esc(rec.source_url) + '" target="_blank" rel="noopener">Source</a>' : ""),
      rec.notes ? '<div class="fs-modal-notes"><div class="fs-label">Notes</div><div class="fs-value">' + esc(rec.notes) + "</div></div>" : ""
    ].join("");
    els.modalOverlay.classList.add("open");
    els.modalClose.focus();
  }

  function closeModal() {
    els.modalOverlay.classList.remove("open");
  }

  function row(label, value) {
    var v = value || "";
    if (!v) return "";
    return '<div class="fs-row"><div class="fs-label">' + esc(label) + '</div><div class="fs-value">' + v + "</div></div>";
  }

  function renderStateLinks() {
    var keys = Object.keys(state.byState).filter(function (k) { return k && k !== "NA"; }).sort();
    els.stateLinks.innerHTML = "";
    for (var i = 0; i < keys.length; i++) {
      var st = keys[i];
      var btn = document.createElement("button");
      btn.type = "button";
      btn.className = "fs-chip";
      btn.textContent = st + " (" + state.byState[st].length + ")";
      btn.setAttribute("data-state", st);
      btn.addEventListener("click", function () {
        var s = this.getAttribute("data-state");
        state.st = s;
        els.filterState.value = s;
        state.page = 1;
        render();
      });
      els.stateLinks.appendChild(btn);
    }
  }

  function paginate(list) {
    var total = list.length;
    var pages = Math.max(1, Math.ceil(total / state.pageSize));
    if (state.page > pages) state.page = pages;
    var start = (state.page - 1) * state.pageSize;
    var end = start + state.pageSize;
    return { pageList: list.slice(start, end), total: total, pages: pages };
  }

  function renderPagination(pages, total) {
    els.pager.innerHTML = "";
    var info = document.createElement("div");
    info.className = "fs-pager-info";
    info.textContent = "Results " + total + ". Page " + state.page + " of " + pages + ".";
    els.pager.appendChild(info);

    var controls = document.createElement("div");
    controls.className = "fs-pager-controls";
    var prev = document.createElement("button");
    prev.type = "button";
    prev.className = "fs-btn";
    prev.textContent = "Prev";
    prev.disabled = state.page <= 1;
    prev.addEventListener("click", function () { state.page -= 1; render(); });

    var next = document.createElement("button");
    next.type = "button";
    next.className = "fs-btn";
    next.textContent = "Next";
    next.disabled = state.page >= pages;
    next.addEventListener("click", function () { state.page += 1; render(); });

    controls.appendChild(prev);
    controls.appendChild(next);
    els.pager.appendChild(controls);
  }

  function renderResults(list) {
    els.results.innerHTML = "";
    if (!list.length) {
      els.results.innerHTML = '<div class="fs-empty">No results found. Try adjusting your search or filters.</div>';
      return;
    }
    for (var i = 0; i < list.length; i++) {
      var rec = list[i];
      var card = document.createElement("div");
      card.className = "fs-card";

      var h = document.createElement("div");
      h.className = "fs-card-title";
      h.textContent = rec.provider_name || "Provider";

      var meta = document.createElement("div");
      meta.className = "fs-card-meta";
      meta.textContent = [rec.city, rec.state].filter(Boolean).join(", ");

      var tags = document.createElement("div");
      tags.className = "fs-card-tags";
      if (rec.cost_type) {
        var costTag = document.createElement("span");
        costTag.className = "fs-tag fs-tag-cost";
        costTag.textContent = rec.cost_type;
        tags.appendChild(costTag);
      }
      if (rec.provider_type) {
        var typeTag = document.createElement("span");
        typeTag.className = "fs-tag fs-tag-type";
        typeTag.textContent = rec.provider_type;
        tags.appendChild(typeTag);
      }

      var btn = document.createElement("button");
      btn.type = "button";
      btn.className = "fs-btn-details";
      btn.textContent = "View details";
      btn.setAttribute("data-index", String(i));
      btn.addEventListener("click", (function (r) {
        return function () { openModal(r); };
      })(rec));

      card.appendChild(h);
      card.appendChild(meta);
      card.appendChild(tags);
      card.appendChild(btn);
      els.results.appendChild(card);
    }
  }

  function render() {
    var filtered = applyFilters(state.all);
    var result = paginate(filtered);
    els.count.textContent = String(result.total);
    renderResults(result.pageList);
    renderPagination(result.pages, result.total);
  }

  function readUrlParams() {
    var params = new URLSearchParams(window.location.search);
    var q = params.get("q");
    var st = params.get("state");
    if (q) { state.q = q; }
    if (st) { state.st = st; }
  }

  function applyUrlToUI() {
    if (state.q && els.q) { els.q.value = state.q; }
    if (state.st && els.filterState) { els.filterState.value = state.st; }
  }

  async function loadData() {
    var allRes = await fetch("./data/swim_lessons.json", { cache: "no-store" });
    var idxRes = await fetch("./data/index_by_state.json", { cache: "no-store" });
    if (!allRes.ok) throw new Error("Data load failed. lessons.json");
    if (!idxRes.ok) throw new Error("Data load failed. index_by_state.json");

    state.all = await allRes.json();
    state.byState = await idxRes.json();

    setStateOptions();
    setOptions(els.filterCost, uniqValues(state.all, "cost_type"), "All costs");
    setOptions(els.filterType, uniqValues(state.all, "provider_type"), "All types");
    renderStateLinks();
    applyUrlToUI();
    render();
  }

  function wire() {
    els.q = $("fs-q");
    els.filterState = $("fs-state");
    els.filterCost = $("fs-cost");
    els.filterType = $("fs-type");
    els.clear = $("fs-clear");
    els.results = $("fs-results");
    els.count = $("fs-count");
    els.pager = $("fs-pager");
    els.stateLinks = $("fs-state-links");
    els.modalOverlay = $("fs-modal");
    els.modalTitle = $("fs-modal-title");
    els.modalBody = $("fs-modal-body");
    els.modalClose = $("fs-modal-close");

    els.q.addEventListener("input", function (e) { state.q = e.target.value || ""; state.page = 1; render(); });
    els.filterState.addEventListener("change", function (e) { state.st = e.target.value || ""; state.page = 1; render(); });
    els.filterCost.addEventListener("change", function (e) { state.cost = e.target.value || ""; state.page = 1; render(); });
    els.filterType.addEventListener("change", function (e) { state.type = e.target.value || ""; state.page = 1; render(); });

    els.clear.addEventListener("click", function () {
      state.q = ""; state.st = ""; state.cost = ""; state.type = ""; state.page = 1;
      els.q.value = ""; els.filterState.value = ""; els.filterCost.value = ""; els.filterType.value = "";
      render();
      els.q.focus();
    });

    els.modalClose.addEventListener("click", closeModal);
    els.modalOverlay.addEventListener("click", function (e) { if (e.target === els.modalOverlay) closeModal(); });
    document.addEventListener("keydown", function (e) { if (e.key === "Escape" && els.modalOverlay.classList.contains("open")) closeModal(); });
  }

  function ensureMarkup() {
    var host = document.querySelector("[data-fs-directory]");
    if (!host) return;
    host.innerHTML = [
      '<div class="fs-dir-head">',
      '  <h1 class="fs-dir-title">Swim Lesson Directory</h1>',
      '  <div class="fs-dir-sub">Search 1,245+ providers by name, city, state, cost, or type.</div>',
      '</div>',
      '<div class="fs-controls">',
      '  <input id="fs-q" class="fs-input" type="text" inputmode="search" placeholder="Search providers, cities, states..." aria-label="Search providers" />',
      '  <select id="fs-state" class="fs-select" aria-label="State filter"></select>',
      '  <select id="fs-cost" class="fs-select" aria-label="Cost filter"></select>',
      '  <select id="fs-type" class="fs-select" aria-label="Type filter"></select>',
      '  <button id="fs-clear" class="fs-btn" type="button">Clear</button>',
      '</div>',
      '<div class="fs-summary">Showing <span id="fs-count">0</span> providers</div>',
      '<div id="fs-results" class="fs-results" aria-live="polite"></div>',
      '<div id="fs-pager" class="fs-pager"></div>',
      '<div class="fs-state-bar" aria-label="Browse by state">',
      '  <div class="fs-state-bar-title">Browse by state</div>',
      '  <div id="fs-state-links" class="fs-state-links"></div>',
      '</div>',
      '<div id="fs-modal" class="fs-modal" role="dialog" aria-modal="true" aria-label="Provider details">',
      '  <div class="fs-modal-panel" role="document">',
      '    <div class="fs-modal-top">',
      '      <div id="fs-modal-title" class="fs-modal-title"></div>',
      '      <button id="fs-modal-close" class="fs-btn" type="button">Close</button>',
      '    </div>',
      '    <div id="fs-modal-body" class="fs-modal-body"></div>',
      '  </div>',
      '</div>'
    ].join("");
  }

  document.addEventListener("DOMContentLoaded", function () {
    readUrlParams();
    ensureMarkup();
    wire();
    loadData().then(function () {
      var q = $("fs-q");
      if (q && !state.q) q.focus();
    }).catch(function (err) {
      console.error(err);
      var host = document.querySelector("[data-fs-directory]");
      if (host) host.innerHTML = '<div class="fs-empty">Data load error. Please try refreshing.</div>';
    });
  });
})();
</script>

  <!-- GSAP Animations -->
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    if (typeof gsap === "undefined") return;
    var prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    if (prefersReduced) return;

    gsap.registerPlugin(ScrollTrigger);

    gsap.utils.toArray("section").forEach(function (sec) {
      gsap.from(sec, {
        opacity: 0, y: 30, duration: 0.7, ease: "power2.out",
        scrollTrigger: { trigger: sec, start: "top 85%", once: true }
      });
    });

    gsap.from(".fs-dir-head", { opacity: 0, y: 20, duration: 0.7, ease: "power2.out" });
    gsap.from(".fs-controls", { opacity: 0, y: 15, duration: 0.6, delay: 0.2, ease: "power2.out" });
  });
  </script>
</body>
</html>
